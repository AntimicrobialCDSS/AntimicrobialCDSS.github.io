<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Infectious Disease Shooter</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%; height: 100% }
    </style>
</head>
<body>
    <canvas id="renderCanvas"></canvas>

    <script src="https://cdn.babylonjs.com/babylon.js"></script>

    <script>
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true);

        var createScene = function () {
            var scene = new BABYLON.Scene(engine);
            var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 5, -10), scene);
            camera.setTarget(BABYLON.Vector3.Zero());
            camera.attachControl(canvas, true);

            var light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
            light.intensity = 0.7;

            var ground = BABYLON.MeshBuilder.CreateGround("ground", {width: 6, height: 6}, scene);

            var machine = BABYLON.MeshBuilder.CreateBox("machine", {height: 1, width: 1, depth: 1}, scene);
            machine.position.y = 1;

            var bacteria = [];
            for (var i = 0; i < 5; i++) {
                var bacterium = BABYLON.MeshBuilder.CreateSphere("bacterium" + i, {diameter: 1, segments: 16}, scene);
                bacterium.position = new BABYLON.Vector3(Math.random() * 6 - 3, 1, Math.random() * 6 - 3);
                bacteria.push(bacterium);
            }

            var shootProjectile = function (direction) {
                var projectile = BABYLON.MeshBuilder.CreateSphere("projectile", {diameter: 0.2, segments: 8}, scene);
                projectile.position = machine.position.clone();
                projectile.physicsImpostor = new BABYLON.PhysicsImpostor(projectile, BABYLON.PhysicsImpostor.SphereImpostor, { mass: 1, restitution: 0.9 }, scene);
                projectile.physicsImpostor.applyImpulse(direction.scale(10), projectile.getAbsolutePosition());
            };

            var keys = {};
            window.addEventListener("keydown", function (event) {
                keys[event.key] = true;
            });

            window.addEventListener("keyup", function (event) {
                keys[event.key] = false;
            });

            scene.onBeforeRenderObservable.add(function () {
                if (keys["ArrowUp"]) {
                    machine.position.z -= 0.1;
                    if (keys[" "]) {
                        shootProjectile(new BABYLON.Vector3(0, 0, -1));
                    }
                }
                if (keys["ArrowDown"]) {
                    machine.position.z += 0.1;
                    if (keys[" "]) {
                        shootProjectile(new BABYLON.Vector3(0, 0, 1));
                    }
                }
                if (keys["ArrowLeft"]) {
                    machine.position.x -= 0.1;
                    if (keys[" "]) {
                        shootProjectile(new BABYLON.Vector3(-1, 0, 0));
                    }
                }
                if (keys["ArrowRight"]) {
                    machine.position.x += 0.1;
                    if (keys[" "]) {
                        shootProjectile(new BABYLON.Vector3(1, 0, 0));
                    }
                }
            });

            return scene;
        };

        var scene = createScene();
        engine.runRenderLoop(function () {
            scene.render();
        });

        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>
